<!doctype html>
<html ng-app="project">

<head>
    <title>Мой Удобный Учет: Личный Кабинет</title>

    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/redmond/jquery-ui.css" />

    <link href="{{ STATIC_URL }}libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <script src="{{ STATIC_URL }}libs/bootstrap/js/bootstrap.min.js"></script>

    <!-- Angular для остатков по счетам для кнопки "Улучшить" и для страницы "Настройки" -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>

    <link rel="stylesheet" href="{{ STATIC_URL }}css/common.css" />

    <link rel="shortcut icon" type="image/png" href="{{ STATIC_URL }}img/favicon.png"/>

    <script src="{{ STATIC_URL }}js/improove_ctrl.js"></script>

    {% block add_to_head %}

    {% endblock %}

</head>

<body>

    <div class="page_content_container" style="position: relative; padding-top: 113px;">

        <a class="logo__text" href="{% url 'my_uu.views.lk_uch' %} " style="position: fixed; top: 16px; margin-left: 50%; left: -430px; z-index: 101;">
            «Мой Удобный Учет»
        </a>

        <div class="logout">
            <span class="logout__email">{{ request.user.username }}</span>
            <a class="logout__link" href="/logout_user/">Выход</a>
        </div>

        <ul class="nav nav-pills" style="position: fixed; visibility: block; top: 73px; z-index: 101;">
            <li{% block uch_active %}{% endblock %}><a href="/lk/">Учет</a></li>
            <li{% block ana_active %}{% endblock %}><a href="/lk/ana/">Анализ</a></li>
            <li{% block set_active %}{% endblock %}><a href="/lk/set/">Настройки</a></li>
        </ul>

        <div style="background-color: white; height: 112px; z-index: 100; position: fixed; width: 860px; top: 0px;"></div>

        <script>
            projectModule = angular.module('project',[]);
        </script>

        {% block lk_content %}

        {% endblock %}

        <style>
            .improove__panel {
                position: fixed;
                right: 0;
                bottom: 50%;
                margin-bottom: -15px;
                width: 120px;
                height: 30px;
                padding: 5px;
                background-color: lavender;
                border: 1px solid lightblue;
                z-index: 105;
            }
            .improove__btn {
                color: rgb(39, 100, 133);
                font-weight: bold;
                width: 120px;
            }
            .improove-dlg {
                position: fixed;
                z-index: 110;
            }
        </style>
        <div class="improove__panel">
            <button class="btn improove__btn" id="improove">Улучшить</button>
        </div>

        <div id="improove-dialog-modal" style="display: none; padding-top: 20px;" ng-controller="ImprooveCtrl">
            <ul>
                <li>Не хватает какой-то функции?</li>
                <li>Что-то работает не так как хочется?</li>
                <li>Что-то не удобно?</li>
            </ul>
            <p>
                Напишите несколько слов об этом в поле ниже и нажмите кнопку "Отправить".
            </p>
            <p>
                Через некоторое время получите уведомление о появлении в сервисе именно той функции, которой Вам так не хватало.
            </p>
            <textarea rows="6" class="span7" ng-show="!isSendToServerNow && !isSendToServerSuccess && !isSendToServerError" style="resize: none;" ng-model="improoveText">
            </textarea>
            <div class="alert alert-info" ng-show="isSendToServerNow">
                Отправка на сервер, подождите...
            </div>
            <div class="alert alert-success" ng-show="isSendToServerSuccess">
                Ваше сообщение успешно отправлено!
            </div>
            <div class="alert alert-error" ng-show="isSendToServerError">
                <span ng:bind="errorText"></span>
            </div>
            <div style="position: absolute; bottom: 15px;">
                <button class="btn btn-success" ng-click="sendToServer()" ng-disabled="isSendToServerNow || isSendToServerSuccess">Отправить</button>
                <button class="btn" ng-click="clearStatus()" id="improoveDlgCloseBtn">Закрыть</button>
            </div>
        </div>

        <script>
            $('#improove').click(function(){
                $( "#improove-dialog-modal" ).dialog({
                    height: 140,
                    modal: true,
                    dialogClass: "improove-dlg",
                    width: 600,
                    height: 400,
                    resizable: false,
                    title: 'Улучшить сервис'
                });
                $( "#improove-dialog-modal").parent().find(".ui-dialog-titlebar-close").html("<span style='position: relative; top: -3px;'>&times;</span>");
            });
            $('#improoveDlgCloseBtn').click(function(){
                $( "#improove-dialog-modal" ).dialog('close');
            });
        </script>

    </div>


    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter21799327 = new Ya.Metrika({id:21799327,
                        webvisor:true,
                        clickmap:true,
                        trackLinks:true,
                        accurateTrackBounce:true,
                        trackHash:true});
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
    </script>
    <noscript><div><img src="//mc.yandex.ru/watch/21799327" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->



</body>
</html>
